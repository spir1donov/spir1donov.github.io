(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{217:(e,t,a)=>{"use strict";a.d(t,{db:()=>n});var r=a(1282);class d extends r.Ay{async addBudgetEntry(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.budgetEntries.add(t)}async updateBudgetEntry(e,t){let a={...t,updatedAt:new Date};await this.budgetEntries.update(e,a)}async deleteBudgetEntry(e){await this.categories.where("budgetId").equals(e).delete(),await this.budgetEntries.delete(e)}async addCategory(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.categories.add(t)}async updateCategory(e,t){let a={...t,updatedAt:new Date};await this.categories.update(e,a)}async deleteCategory(e){await this.transactions.where("categoryId").equals(e).modify({categoryId:0}),await this.categories.delete(e)}async getCategoriesByBudget(e){return await this.categories.where("budgetId").equals(e).toArray()}async addTransaction(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.transactions.add(t)}async updateTransaction(e,t){let a={...t,updatedAt:new Date};await this.transactions.update(e,a)}async deleteTransaction(e){await this.receipts.where("transactionId").equals(e).modify({transactionId:void 0}),await this.transactions.delete(e)}async getTransactionsByCategory(e){return await this.transactions.where("categoryId").equals(e).toArray()}async getTransactionsByDateRange(e,t){return await this.transactions.where("date").between(e,t).toArray()}async addReceipt(e){if(await this.receipts.where(["fn","i","fp"]).equals([e.fn,e.i,e.fp]).first())throw Error("Receipt already exists with fiscal number: ".concat(e.fn,", receipt number: ").concat(e.i,", fiscal sign: ").concat(e.fp));let t={...e,createdAt:new Date,updatedAt:new Date},a=await this.receipts.add(t);try{let t=this.parseReceiptTimestamp(e.t),r=parseFloat(e.s)||0,d=await this.getDefaultCategory(),n={date:t.date,time:t.time,categoryId:d.id||0,payerPayee:"Receipt ".concat(e.fn),amount:r,direction:"outgoing",receiptId:a,comment:"Auto-generated from receipt: ".concat(e.fn)},i=await this.addTransaction(n);await this.receipts.update(a,{transactionId:i})}catch(e){console.error("Failed to create transaction from receipt:",e)}return a}parseReceiptTimestamp(e){try{let t=parseInt(e.substring(0,4)),a=parseInt(e.substring(4,6))-1,r=parseInt(e.substring(6,8)),d=parseInt(e.substring(9,11))||0,n=parseInt(e.substring(11,13))||0,i=new Date(t,a,r),s="".concat(d.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"));return{date:i,time:s}}catch(t){let e=new Date;return{date:e,time:e.toTimeString().slice(0,5)}}}async getDefaultCategory(){let e=(await this.categories.toArray())[0];if(e)return e;let t=await this.addCategory({name:"General",description:"Default category for receipts",budgetId:0});return await this.categories.get(t)}async updateReceipt(e,t){let a={...t,updatedAt:new Date};await this.receipts.update(e,a)}async deleteReceipt(e){await this.transactions.where("receiptId").equals(e).modify({receiptId:void 0}),await this.receipts.delete(e)}async getReceiptByTransaction(e){return await this.receipts.where("transactionId").equals(e).first()}async getTransactionWithDetails(e){let t=await this.transactions.get(e);if(!t)return;let a=await this.categories.get(t.categoryId),r=t.receiptId?await this.receipts.get(t.receiptId):void 0;return{transaction:t,category:a,receipt:r}}async getBudgetWithCategories(e){let t=await this.budgetEntries.get(e);if(t)return{budget:t,categories:await this.getCategoriesByBudget(e)}}constructor(){super("FinanceDatabase"),this.version(1).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt"}),this.version(2).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt, [categoryId+date]",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt"}),this.version(3).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt, [categoryId+date]",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt, [fn+i+fp]"}),this.version(4).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, time, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt, [categoryId+date]",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt, [fn+i+fp]"})}}let n=new d},239:e=>{"use strict";e.exports=JSON.parse('{"name":"storage","version":"0.1.67","private":true,"scripts":{"dev":"next dev --experimental-https","build":"next build","start":"next start","lint":"next lint","copy":"rm -fr ../spir1donov.github.io/storage && cp -r out ../spir1donov.github.io/storage/","deploy":"cd ../spir1donov.github.io && git add . && git commit -m \\"deploy $(date -u +\'%Y%m%d%H%M%S\')\\" && git push","bump":"npm version patch --git-tag-version false","publish":"npm run bump && npm run build && npm run copy && npm run deploy"},"dependencies":{"@yudiel/react-qr-scanner":"^2.3.1","dexie":"^4.0.11","dexie-react-hooks":"^1.1.7","next":"15.3.4","react":"^19.0.0","react-dom":"^19.0.0"},"devDependencies":{"@eslint/eslintrc":"^3","@types/node":"^20","@types/react":"^19","@types/react-dom":"^19","autoprefixer":"^10.4.21","eslint":"^9","eslint-config-next":"15.3.4","tailwindcss":"^3.4.0","typescript":"^5"}}')},3159:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(6814),d=a(2094),n=a(217),i=a(6271),s=a(6979);function o(){let[e,t]=(0,d.useState)({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),categoryId:0,payerPayee:"",amount:0,comment:"",direction:"outgoing"}),[a,o]=(0,d.useState)(null),[c,u]=(0,d.useState)({date:"",time:"",categoryId:0,payerPayee:"",amount:0,comment:"",direction:"outgoing"}),[g,l]=(0,d.useState)(null),[p,y]=(0,d.useState)(null),h=(0,i.kk)(()=>n.db.transactions.toArray(),[],[]),m=(0,i.kk)(()=>n.db.categories.toArray(),[],[]),b=async a=>{if(a.preventDefault(),e.payerPayee.trim()&&!(e.amount<=0)&&!(e.categoryId<=0))try{let a={...e,date:new Date(e.date)};await n.db.addTransaction(a),t({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),categoryId:0,payerPayee:"",amount:0,comment:"",direction:"outgoing"}),y("Transaction added successfully!"),setTimeout(()=>y(null),s.Ez)}catch(e){console.error("Error adding transaction:",e),l("Failed to add transaction")}},x=e=>{o(e),u({date:new Date(e.date).toISOString().split("T")[0],time:e.time||"",categoryId:e.categoryId,payerPayee:e.payerPayee||"",amount:e.amount,comment:e.comment||"",direction:e.direction||"outgoing"})},w=async e=>{if(e.preventDefault(),(null==a?void 0:a.id)&&c.payerPayee.trim()&&!(c.amount<=0)&&!(c.categoryId<=0))try{let e={...c,date:new Date(c.date)};await n.db.updateTransaction(a.id,e),o(null),y("Transaction updated successfully!"),setTimeout(()=>y(null),s.Ez)}catch(e){console.error("Error updating transaction:",e),l("Failed to update transaction")}},v=()=>{o(null),u({date:"",time:"",categoryId:0,payerPayee:"",amount:0,comment:"",direction:"outgoing"})},f=async e=>{try{await n.db.deleteTransaction(e),y("Transaction deleted successfully!"),setTimeout(()=>y(null),s.Ez)}catch(e){console.error("Error deleting transaction:",e),l("Failed to delete transaction")}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 md:pb-0 md:pt-16",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-center mb-8 text-gray-900 dark:text-white",children:"Transactions"}),g&&(0,r.jsx)("div",{className:"bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-6",children:g}),p&&(0,r.jsx)("div",{className:"bg-green-100 dark:bg-green-900/20 border border-green-400 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded mb-6",children:p}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-900/50 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:"Add New Transaction"}),(0,r.jsxs)("form",{onSubmit:b,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,r.jsx)("input",{type:"date",value:e.date,onChange:a=>t({...e,date:a.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0}),(0,r.jsx)("input",{type:"time",value:e.time,onChange:a=>t({...e,time:a.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,r.jsxs)("select",{value:e.categoryId,onChange:a=>t({...e,categoryId:parseInt(a.target.value)||0}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:0,children:"Select Category"}),m&&m.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,r.jsx)("input",{type:"text",placeholder:"Payer/Payee",value:e.payerPayee,onChange:a=>t({...e,payerPayee:a.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",required:!0}),(0,r.jsx)("input",{type:"number",placeholder:"Amount",value:e.amount,onChange:a=>t({...e,amount:parseFloat(a.target.value)||0}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",step:"0.01",required:!0}),(0,r.jsxs)("select",{value:e.direction,onChange:a=>t({...e,direction:a.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:"outgoing",children:"Outgoing"}),(0,r.jsx)("option",{value:"incoming",children:"Incoming"})]}),(0,r.jsx)("input",{type:"text",placeholder:"Comment (optional)",value:e.comment,onChange:a=>t({...e,comment:a.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"}),(0,r.jsx)("button",{type:"submit",className:"bg-purple-600 dark:bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-700 dark:hover:bg-purple-600 transition-colors duration-200",children:"Add Transaction"})]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-900/50",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold p-6 border-b border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white",children:"Your Transactions"}),h&&h.length>0?(0,r.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:h.map(e=>{var t;return(0,r.jsx)("div",{className:"p-6",children:(null==a?void 0:a.id)===e.id?(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)("input",{type:"date",value:c.date,onChange:e=>u({...c,date:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0}),(0,r.jsx)("input",{type:"time",value:c.time,onChange:e=>u({...c,time:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,r.jsxs)("select",{value:c.categoryId,onChange:e=>u({...c,categoryId:parseInt(e.target.value)||0}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:0,children:"Select Category"}),m&&m.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,r.jsx)("input",{type:"text",placeholder:"Payer/Payee",value:c.payerPayee,onChange:e=>u({...c,payerPayee:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",required:!0}),(0,r.jsx)("input",{type:"number",placeholder:"Amount",value:c.amount,onChange:e=>u({...c,amount:parseFloat(e.target.value)||0}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",step:"0.01",required:!0}),(0,r.jsxs)("select",{value:c.direction,onChange:e=>u({...c,direction:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:"outgoing",children:"Outgoing"}),(0,r.jsx)("option",{value:"incoming",children:"Incoming"})]}),(0,r.jsx)("input",{type:"text",placeholder:"Comment (optional)",value:c.comment,onChange:e=>u({...c,comment:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"submit",className:"bg-green-600 dark:bg-green-500 text-white px-4 py-2 rounded hover:bg-green-700 dark:hover:bg-green-600 transition-colors duration-200",children:"Save Changes"}),(0,r.jsx)("button",{type:"button",onClick:v,className:"bg-gray-600 dark:bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors duration-200",children:"Cancel"})]})]}):(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:e.payerPayee}),(0,r.jsxs)("span",{className:"px-2 py-1 rounded text-sm font-medium ".concat("incoming"===e.direction?"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400":"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-400"),children:["$",e.amount.toFixed(2)]}),(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:m&&(null==(t=m.find(t=>t.id===e.categoryId))?void 0:t.name)})]}),e.comment&&(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:e.comment}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[new Date(e.date).toLocaleDateString(),e.time&&" at ".concat(e.time)]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(e),className:"bg-blue-600 dark:bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-700 dark:hover:bg-blue-600 text-sm transition-colors duration-200",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>e.id&&f(e.id),className:"bg-red-600 dark:bg-red-500 text-white px-3 py-1 rounded hover:bg-red-700 dark:hover:bg-red-600 text-sm transition-colors duration-200",children:"Delete"})]})]})},e.id)})}):(0,r.jsx)("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:"No transactions found. Add your first transaction above."})]})]})})}},6271:(e,t,a)=>{"use strict";a.d(t,{kk:()=>n});var r=a(1282),d=a(2094);function n(e,t,a){return function(e,t,a){"function"==typeof e?(r=t||[],n=a):(r=[],n=t);var r,n,i=d.useRef({hasResult:!1,result:n,error:null}),s=d.useReducer(function(e){return e+1},0);s[0];var o=s[1],c=d.useMemo(function(){var t="function"==typeof e?e():e;if(!t||"function"!=typeof t.subscribe)if(e===t)throw TypeError("Given argument to useObservable() was neither a valid observable nor a function.");else throw TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!i.current.hasResult&&"undefined"!=typeof window&&("function"!=typeof t.hasValue||t.hasValue()))if("function"==typeof t.getValue)i.current.result=t.getValue(),i.current.hasResult=!0;else{var a=t.subscribe(function(e){i.current.result=e,i.current.hasResult=!0});"function"==typeof a?a():a.unsubscribe()}return t},r);if(d.useDebugValue(i.current.result),d.useEffect(function(){var e=c.subscribe(function(e){var t=i.current;(null!==t.error||t.result!==e)&&(t.error=null,t.result=e,t.hasResult=!0,o())},function(e){var t=i.current;t.error!==e&&(t.error=e,o())});return"function"==typeof e?e:e.unsubscribe.bind(e)},r),i.current.error)throw i.current.error;return i.current.result}(function(){return(0,r.Dd)(e)},t||[],a)}},6979:(e,t,a)=>{"use strict";a.d(t,{C3:()=>d,Ez:()=>r,hl:()=>n});let r=5e3,d="FinanceTracker",n="0.1.0";try{n=a(239).version||n}catch(e){console.warn("Could not load version from package.json, using default:",n)}},9752:(e,t,a)=>{Promise.resolve().then(a.bind(a,3159))}},e=>{var t=t=>e(e.s=t);e.O(0,[282,788,97,358],()=>t(9752)),_N_E=e.O()}]);