(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{217:(e,t,r)=>{"use strict";r.d(t,{db:()=>s});var a=r(1282);class d extends a.Ay{async addBudgetEntry(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.budgetEntries.add(t)}async updateBudgetEntry(e,t){let r={...t,updatedAt:new Date};await this.budgetEntries.update(e,r)}async deleteBudgetEntry(e){await this.categories.where("budgetId").equals(e).delete(),await this.budgetEntries.delete(e)}async addCategory(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.categories.add(t)}async updateCategory(e,t){let r={...t,updatedAt:new Date};await this.categories.update(e,r)}async deleteCategory(e){await this.transactions.where("categoryId").equals(e).modify({categoryId:0}),await this.categories.delete(e)}async getCategoriesByBudget(e){return await this.categories.where("budgetId").equals(e).toArray()}async addTransaction(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.transactions.add(t)}async updateTransaction(e,t){let r={...t,updatedAt:new Date};await this.transactions.update(e,r)}async deleteTransaction(e){await this.receipts.where("transactionId").equals(e).modify({transactionId:void 0}),await this.transactions.delete(e)}async getTransactionsByCategory(e){return await this.transactions.where("categoryId").equals(e).toArray()}async getTransactionsByDateRange(e,t){return await this.transactions.where("date").between(e,t).toArray()}async addReceipt(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.receipts.add(t)}async updateReceipt(e,t){let r={...t,updatedAt:new Date};await this.receipts.update(e,r)}async deleteReceipt(e){await this.transactions.where("receiptId").equals(e).modify({receiptId:void 0}),await this.receipts.delete(e)}async getReceiptByTransaction(e){return await this.receipts.where("transactionId").equals(e).first()}async getTransactionWithDetails(e){let t=await this.transactions.get(e);if(!t)return;let r=await this.categories.get(t.categoryId),a=t.receiptId?await this.receipts.get(t.receiptId):void 0;return{transaction:t,category:r,receipt:a}}async getBudgetWithCategories(e){let t=await this.budgetEntries.get(e);if(t)return{budget:t,categories:await this.getCategoriesByBudget(e)}}constructor(){super("FinanceDatabase"),this.version(1).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt"}),this.version(2).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt, [categoryId+date]",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt"})}}let s=new d},239:e=>{"use strict";e.exports=JSON.parse('{"name":"storage","version":"0.1.1","private":true,"scripts":{"dev":"next dev --experimental-https","build":"next build","start":"next start","lint":"next lint","copy":"rm -fr ../spir1donov.github.io/storage && cp -r out ../spir1donov.github.io/storage/","deploy":"cd ../spir1donov.github.io && git add . && git commit -m \\"deploy $(date -u +\'%Y%m%d%H%M%S\')\\" && git push","publish":"npm run build && npm run copy && npm run deploy"},"dependencies":{"@yudiel/react-qr-scanner":"^2.3.1","dexie":"^4.0.11","dexie-react-hooks":"^1.1.7","next":"15.3.4","react":"^19.0.0","react-dom":"^19.0.0"},"devDependencies":{"@eslint/eslintrc":"^3","@types/node":"^20","@types/react":"^19","@types/react-dom":"^19","autoprefixer":"^10.4.21","eslint":"^9","eslint-config-next":"15.3.4","tailwindcss":"^3.4.0","typescript":"^5"}}')},1913:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(6814),d=r(2094),s=r(217),i=r(6271),n=r(324),l=r(6979);function c(){let[e,t]=(0,d.useState)(!0),[r,c]=(0,d.useState)(null),[o,g]=(0,d.useState)(null),[u,x]=(0,d.useState)(null),h=(0,i.kk)(()=>s.db.receipts.orderBy("createdAt").reverse().limit(5).toArray(),[],[]),b=(0,d.useCallback)(e=>{try{let t=Object.fromEntries(new URLSearchParams(e));if(!["t","s","fn","i","fp","n"].every(e=>t.hasOwnProperty(e)))return null;return{t:t.t||"",s:t.s||"",fn:t.fn||"",i:t.i||"",fp:t.fp||"",n:t.n||""}}catch(e){return null}},[]),p=(0,d.useCallback)(async e=>{if(!e)return;c(e),g(null),x(null);let t=b(e);if(!t)return void g("QR code does not contain valid receipt data. Required: t, s, fn, i, fp, n");try{await s.db.addReceipt(t),x("Receipt added successfully!"),setTimeout(()=>x(null),l.Ez)}catch(e){g("Failed to add receipt to database")}},[b]),y=(0,d.useCallback)(e=>{g("Failed to scan QR code. Please try again.")},[]);return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-900 dark:text-white",children:"QR Receipt Scanner"}),o&&(0,a.jsx)("div",{className:"bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:o}),u&&(0,a.jsx)("div",{className:"bg-green-100 dark:bg-green-900/20 border border-green-400 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded",children:u}),(0,a.jsx)("div",{className:"flex justify-center space-x-4 mb-4",children:(0,a.jsx)("button",{onClick:()=>t(e=>!e),className:"px-6 py-3 rounded-lg font-semibold transition-colors duration-200 ".concat(e?"bg-red-600 dark:bg-red-500 text-white hover:bg-red-700 dark:hover:bg-red-600":"bg-blue-600 dark:bg-blue-500 text-white hover:bg-blue-700 dark:hover:bg-blue-600"),children:e?"Stop Scanning":"Start Camera Scanner"})}),e&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg dark:shadow-gray-900/50",children:[(0,a.jsx)("div",{className:"text-center mb-4",children:(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Position the QR code within the scanner"})}),(0,a.jsx)("div",{className:"w-full max-w-md mx-auto",style:{width:"100%"},children:(0,a.jsx)(n.Lp,{onScan:e=>{e&&e.length>0&&e[0].rawValue&&p(e[0].rawValue)},onError:y,constraints:{facingMode:"environment"}})})]}),r&&(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2 text-gray-900 dark:text-white",children:"Last Processed:"}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 p-3 rounded border border-gray-200 dark:border-gray-600 font-mono text-sm break-all text-gray-900 dark:text-white",children:r})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-900/50",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Recent Receipts"}),h&&h.length>0?(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded p-3 bg-gray-50 dark:bg-gray-700",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Timestamp:"})," ",e.t]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Sum:"})," ",e.s]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Fiscal Number:"})," ",e.fn]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Receipt Number:"})," ",e.i]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Fiscal Sign:"})," ",e.fp]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",e.n]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Added: ",e.createdAt?new Date(e.createdAt).toLocaleString():"Unknown"]})]},e.id))}):(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No receipts scanned yet"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2 text-gray-900 dark:text-white",children:"How to use:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700 dark:text-gray-300",children:[(0,a.jsx)("li",{children:'Click "Start Camera Scanner" to activate the camera'}),(0,a.jsx)("li",{children:"Position the QR code within the scanner view"}),(0,a.jsx)("li",{children:"The scanner will automatically detect and parse receipt data"}),(0,a.jsx)("li",{children:"Valid receipts will be automatically added to the database"}),(0,a.jsx)("li",{children:"Recent receipts are shown below"})]})]})]})}function o(){let[e,t]=(0,d.useState)("scanner"),[r,n]=(0,d.useState)({t:"",s:"",fn:"",i:"",fp:"",n:"",transactionId:0}),[o,g]=(0,d.useState)(null),[u,x]=(0,d.useState)(null),h=(0,i.kk)(()=>s.db.receipts.orderBy("createdAt").reverse().limit(5).toArray(),[],[]);async function b(e){if(e.preventDefault(),r.t&&r.s&&r.fn&&r.i&&r.fp&&r.n)try{await s.db.addReceipt(r),n({t:"",s:"",fn:"",i:"",fp:"",n:"",transactionId:0}),x("Receipt added successfully!"),setTimeout(()=>x(null),l.Ez)}catch(e){console.error("Error adding receipt:",e),g("Failed to add receipt")}}return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 md:pb-0 md:pt-16",children:[(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-40 md:top-16",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-4",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-full p-1 flex",children:[(0,a.jsx)("button",{onClick:()=>t("scanner"),className:"px-6 py-2 rounded-full text-sm font-medium transition-all duration-200 ".concat("scanner"===e?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100"),children:"QR Scanner"}),(0,a.jsx)("button",{onClick:()=>t("manual"),className:"px-6 py-2 rounded-full text-sm font-medium transition-all duration-200 ".concat("manual"===e?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100"),children:"Manual Entry"})]})})})}),"scanner"===e&&(0,a.jsx)(c,{}),"manual"===e&&(0,a.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-900/50",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold p-6 border-b border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white",children:"Manual Receipt Entry"}),o&&(0,a.jsx)("div",{className:"mx-6 mt-6 bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:o}),u&&(0,a.jsx)("div",{className:"mx-6 mt-6 bg-green-100 dark:bg-green-900/20 border border-green-400 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded",children:u}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Timestamp (t)"}),(0,a.jsx)("input",{type:"text",placeholder:"20231201T120000",value:r.t,onChange:e=>n({...r,t:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sum (s)"}),(0,a.jsx)("input",{type:"text",placeholder:"100.00",value:r.s,onChange:e=>n({...r,s:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Fiscal Number (fn)"}),(0,a.jsx)("input",{type:"text",placeholder:"1234567890",value:r.fn,onChange:e=>n({...r,fn:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Receipt Number (i)"}),(0,a.jsx)("input",{type:"text",placeholder:"12345",value:r.i,onChange:e=>n({...r,i:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Fiscal Sign (fp)"}),(0,a.jsx)("input",{type:"text",placeholder:"67890",value:r.fp,onChange:e=>n({...r,fp:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Receipt Type (n)"}),(0,a.jsx)("input",{type:"text",placeholder:"1",value:r.n,onChange:e=>n({...r,n:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",required:!0})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{type:"submit",className:"bg-orange-600 dark:bg-orange-500 text-white px-8 py-3 rounded-lg hover:bg-orange-700 dark:hover:bg-orange-600 font-medium transition-colors duration-200",children:"Add Receipt"})})]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-900/50",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold p-6 border-b border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white",children:"Recent Receipts"}),h&&h.length>0?(0,a.jsx)("div",{className:"p-6 space-y-4",children:h.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-gray-50 dark:bg-gray-700",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 text-sm text-gray-700 dark:text-gray-300",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Timestamp:"})," ",e.t]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Sum:"})," ",e.s]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Fiscal Number:"})," ",e.fn]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Receipt Number:"})," ",e.i]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Fiscal Sign:"})," ",e.fp]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",e.n]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3",children:["Added: ",e.createdAt?new Date(e.createdAt).toLocaleString():"Unknown"]})]},e.id))}):(0,a.jsx)("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:"No receipts found. Scan a QR code or add one manually above."})]}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3 text-gray-900 dark:text-white",children:"How to use Manual Entry:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700 dark:text-gray-300",children:[(0,a.jsx)("li",{children:"Fill in all the required receipt fields above"}),(0,a.jsx)("li",{children:"Use the format shown in the placeholders"}),(0,a.jsx)("li",{children:'Click "Add Receipt" to save to your database'}),(0,a.jsx)("li",{children:"Recent receipts will appear below"})]}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h4",{className:"font-semibold text-sm mb-2 text-gray-900 dark:text-white",children:"Example Receipt Data:"}),(0,a.jsxs)("div",{className:"text-xs space-y-1 text-gray-700 dark:text-gray-300",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"t:"})," 20231201T120000"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"s:"})," 100.00"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"fn:"})," 1234567890"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"i:"})," 12345"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"fp:"})," 67890"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"n:"})," 1"]})]})]})]})]})]})}},6979:(e,t,r)=>{"use strict";r.d(t,{C3:()=>d,Ez:()=>a,hl:()=>s});let a=5e3,d="FinanceTracker",s="0.1.0";try{let e=r(239);s=e.version||s,s=e.name||d}catch(e){console.warn("Could not load version from package.json, using default:",s)}},7299:(e,t,r)=>{Promise.resolve().then(r.bind(r,1913))}},e=>{var t=t=>e(e.s=t);e.O(0,[282,172,788,97,358],()=>t(7299)),_N_E=e.O()}]);