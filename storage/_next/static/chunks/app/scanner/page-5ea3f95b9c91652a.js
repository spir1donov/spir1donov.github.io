(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{217:(e,t,a)=>{"use strict";a.d(t,{db:()=>d});var s=a(1282);class r extends s.Ay{async addBudgetEntry(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.budgetEntries.add(t)}async updateBudgetEntry(e,t){let a={...t,updatedAt:new Date};await this.budgetEntries.update(e,a)}async deleteBudgetEntry(e){await this.categories.where("budgetId").equals(e).delete(),await this.budgetEntries.delete(e)}async addCategory(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.categories.add(t)}async updateCategory(e,t){let a={...t,updatedAt:new Date};await this.categories.update(e,a)}async deleteCategory(e){await this.transactions.where("categoryId").equals(e).modify({categoryId:0}),await this.categories.delete(e)}async getCategoriesByBudget(e){return await this.categories.where("budgetId").equals(e).toArray()}async addTransaction(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.transactions.add(t)}async updateTransaction(e,t){let a={...t,updatedAt:new Date};await this.transactions.update(e,a)}async deleteTransaction(e){await this.receipts.where("transactionId").equals(e).modify({transactionId:void 0}),await this.transactions.delete(e)}async getTransactionsByCategory(e){return await this.transactions.where("categoryId").equals(e).toArray()}async getTransactionsByDateRange(e,t){return await this.transactions.where("date").between(e,t).toArray()}async addReceipt(e){let t={...e,createdAt:new Date,updatedAt:new Date};return await this.receipts.add(t)}async updateReceipt(e,t){let a={...t,updatedAt:new Date};await this.receipts.update(e,a)}async deleteReceipt(e){await this.transactions.where("receiptId").equals(e).modify({receiptId:void 0}),await this.receipts.delete(e)}async getReceiptByTransaction(e){return await this.receipts.where("transactionId").equals(e).first()}async getTransactionWithDetails(e){let t=await this.transactions.get(e);if(!t)return;let a=await this.categories.get(t.categoryId),s=t.receiptId?await this.receipts.get(t.receiptId):void 0;return{transaction:t,category:a,receipt:s}}async getBudgetWithCategories(e){let t=await this.budgetEntries.get(e);if(t)return{budget:t,categories:await this.getCategoriesByBudget(e)}}constructor(){super("FinanceDatabase"),this.version(1).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt"}),this.version(2).stores({budgetEntries:"++id, name, amount, createdAt, updatedAt",categories:"++id, name, description, budgetId, createdAt, updatedAt",transactions:"++id, date, categoryId, payerPayee, amount, direction, receiptId, createdAt, updatedAt, [categoryId+date]",receipts:"++id, t, s, fn, i, fp, n, transactionId, createdAt, updatedAt"})}}let d=new r},1913:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(6814),r=a(2094),d=a(217),i=a(6271),n=a(324);function l(){let[e,t]=(0,r.useState)(!0),[a,l]=(0,r.useState)(null),[c,o]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),x=(0,i.kk)(()=>d.db.receipts.orderBy("createdAt").reverse().limit(5).toArray(),[],[]),m=(0,r.useCallback)(e=>{try{let t=Object.fromEntries(new URLSearchParams(e));if(!["t","s","fn","i","fp","n"].every(e=>t.hasOwnProperty(e)))return null;return{t:t.t||"",s:t.s||"",fn:t.fn||"",i:t.i||"",fp:t.fp||"",n:t.n||""}}catch(e){return null}},[]),p=(0,r.useCallback)(async e=>{if(!e)return;l(e),o(null),h(null);let t=m(e);if(!t)return void o("QR code does not contain valid receipt data. Required: t, s, fn, i, fp, n");try{await d.db.addReceipt(t),h("Receipt added successfully!"),setTimeout(()=>h(null),3e3)}catch(e){o("Failed to add receipt to database")}},[m]),g=(0,r.useCallback)(e=>{o("Failed to scan QR code. Please try again.")},[]);return(0,s.jsxs)("div",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-center",children:"QR Receipt Scanner"}),c&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:c}),u&&(0,s.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:u}),(0,s.jsx)("div",{className:"flex justify-center space-x-4 mb-4",children:(0,s.jsx)("button",{onClick:()=>t(e=>!e),className:"px-6 py-3 rounded-lg font-semibold ".concat(e?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"),children:e?"Stop Scanning":"Start Camera Scanner"})}),e&&(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg",children:[(0,s.jsx)("div",{className:"text-center mb-4",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Position the QR code within the scanner"})}),(0,s.jsx)("div",{className:"w-full max-w-md mx-auto",style:{width:"100%"},children:(0,s.jsx)(n.Lp,{onScan:e=>{e&&e.length>0&&e[0].rawValue&&p(e[0].rawValue)},onError:g,constraints:{facingMode:"environment"}})})]}),a&&(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Last Processed:"}),(0,s.jsx)("div",{className:"bg-white p-3 rounded border font-mono text-sm break-all",children:a})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Receipts"}),x&&x.length>0?(0,s.jsx)("div",{className:"space-y-3",children:x.map(e=>(0,s.jsxs)("div",{className:"border rounded p-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Timestamp:"})," ",e.t]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Sum:"})," ",e.s]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Fiscal Number:"})," ",e.fn]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Receipt Number:"})," ",e.i]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Fiscal Sign:"})," ",e.fp]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Type:"})," ",e.n]})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Added: ",e.createdAt?new Date(e.createdAt).toLocaleString():"Unknown"]})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center",children:"No receipts scanned yet"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"How to use:"}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[(0,s.jsx)("li",{children:'Click "Start Camera Scanner" to activate the camera'}),(0,s.jsx)("li",{children:"Position the QR code within the scanner view"}),(0,s.jsx)("li",{children:"The scanner will automatically detect and parse receipt data"}),(0,s.jsx)("li",{children:"Valid receipts will be automatically added to the database"}),(0,s.jsx)("li",{children:"Recent receipts are shown below"})]})]})]})}function c(){let[e,t]=(0,r.useState)("scanner"),[a,n]=(0,r.useState)({t:"",s:"",fn:"",i:"",fp:"",n:"",transactionId:0}),[c,o]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),x=(0,i.kk)(()=>d.db.receipts.orderBy("createdAt").reverse().limit(5).toArray(),[],[]);async function m(e){if(e.preventDefault(),a.t&&a.s&&a.fn&&a.i&&a.fp&&a.n)try{await d.db.addReceipt(a),n({t:"",s:"",fn:"",i:"",fp:"",n:"",transactionId:0}),h("Receipt added successfully!"),setTimeout(()=>h(null),3e3)}catch(e){console.error("Error adding receipt:",e),o("Failed to add receipt")}}return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-0 md:pt-16",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40 md:top-16",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-4",children:(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"bg-gray-100 rounded-full p-1 flex",children:[(0,s.jsx)("button",{onClick:()=>t("scanner"),className:"px-6 py-2 rounded-full text-sm font-medium transition-all duration-200 ".concat("scanner"===e?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"QR Scanner"}),(0,s.jsx)("button",{onClick:()=>t("manual"),className:"px-6 py-2 rounded-full text-sm font-medium transition-all duration-200 ".concat("manual"===e?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"Manual Entry"})]})})})}),"scanner"===e&&(0,s.jsx)(l,{}),"manual"===e&&(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold p-6 border-b",children:"Manual Receipt Entry"}),c&&(0,s.jsx)("div",{className:"mx-6 mt-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:c}),u&&(0,s.jsx)("div",{className:"mx-6 mt-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:u}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timestamp (t)"}),(0,s.jsx)("input",{type:"text",placeholder:"20231201T120000",value:a.t,onChange:e=>n({...a,t:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sum (s)"}),(0,s.jsx)("input",{type:"text",placeholder:"100.00",value:a.s,onChange:e=>n({...a,s:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fiscal Number (fn)"}),(0,s.jsx)("input",{type:"text",placeholder:"1234567890",value:a.fn,onChange:e=>n({...a,fn:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Number (i)"}),(0,s.jsx)("input",{type:"text",placeholder:"12345",value:a.i,onChange:e=>n({...a,i:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fiscal Sign (fp)"}),(0,s.jsx)("input",{type:"text",placeholder:"67890",value:a.fp,onChange:e=>n({...a,fp:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Type (n)"}),(0,s.jsx)("input",{type:"text",placeholder:"1",value:a.n,onChange:e=>n({...a,n:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("button",{type:"submit",className:"bg-orange-600 text-white px-8 py-3 rounded-lg hover:bg-orange-700 font-medium",children:"Add Receipt"})})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold p-6 border-b",children:"Recent Receipts"}),x&&x.length>0?(0,s.jsx)("div",{className:"p-6 space-y-4",children:x.map(e=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Timestamp:"})," ",e.t]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Sum:"})," ",e.s]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Fiscal Number:"})," ",e.fn]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Receipt Number:"})," ",e.i]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Fiscal Sign:"})," ",e.fp]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Type:"})," ",e.n]})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-3",children:["Added: ",e.createdAt?new Date(e.createdAt).toLocaleString():"Unknown"]})]},e.id))}):(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No receipts found. Scan a QR code or add one manually above."})]}),(0,s.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-3",children:"How to use Manual Entry:"}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,s.jsx)("li",{children:"Fill in all the required receipt fields above"}),(0,s.jsx)("li",{children:"Use the format shown in the placeholders"}),(0,s.jsx)("li",{children:'Click "Add Receipt" to save to your database'}),(0,s.jsx)("li",{children:"Recent receipts will appear below"})]}),(0,s.jsxs)("div",{className:"mt-4 p-3 bg-white rounded border",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm mb-2",children:"Example Receipt Data:"}),(0,s.jsxs)("div",{className:"text-xs space-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"t:"})," 20231201T120000"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"s:"})," 100.00"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"fn:"})," 1234567890"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"i:"})," 12345"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"fp:"})," 67890"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"n:"})," 1"]})]})]})]})]})]})}},7299:(e,t,a)=>{Promise.resolve().then(a.bind(a,1913))}},e=>{var t=t=>e(e.s=t);e.O(0,[271,324,788,97,358],()=>t(7299)),_N_E=e.O()}]);